import{e as K,u as N,f as X,g as Z,j as ee,t as te,h as le,i as D,k as R,l as e,m as ne,w as se,s as ae,R as I,n as oe,p as ce,q as re,v as ie,x as ue,y as T,z as j,A as he,B as me,C as ve,D as de,L as ye,E as pe,F as ge,G as fe,H as U,I as He,J as w}from"./app-CNdlfKLn.js";const ke=["/","/collection/2024.html","/collection/2025.html","/content/2024/1.html","/content/2024/10.html","/content/2024/11.html","/content/2024/12.html","/content/2024/13.html","/content/2024/14.html","/content/2024/15.html","/content/2024/16.html","/content/2024/17.html","/content/2024/18.html","/content/2024/19.html","/content/2024/2.html","/content/2024/20.html","/content/2024/21.html","/content/2024/22.html","/content/2024/23.html","/content/2024/24.html","/content/2024/25.html","/content/2024/26.html","/content/2024/27.html","/content/2024/28.html","/content/2024/29.html","/content/2024/3.html","/content/2024/30.html","/content/2024/4.html","/content/2024/5.html","/content/2024/6.html","/content/2024/7.html","/content/2024/8.html","/content/2024/9.html","/content/2026/77.html","/content/2026/78.html","/content/2026/79.html","/content/2026/80.html","/content/2026/81.html","/content/2026/82.html","/content/2025/31.html","/content/2025/32.html","/content/2025/33.html","/content/2025/34.html","/content/2025/35.html","/content/2025/36.html","/content/2025/37.html","/content/2025/38.html","/content/2025/39.html","/content/2025/40.html","/content/2025/41.html","/content/2025/42.html","/content/2025/43.html","/content/2025/44.html","/content/2025/45.html","/content/2025/46.html","/content/2025/47.html","/content/2025/48.html","/content/2025/49.html","/content/2025/50.html","/content/2025/51.html","/content/2025/52.html","/content/2025/53.html","/content/2025/54.html","/content/2025/55.html","/content/2025/56.html","/content/2025/57.html","/content/2025/58.html","/content/2025/59.html","/content/2025/60.html","/content/2025/61.html","/content/2025/62.html","/content/2025/63.html","/content/2025/64.html","/content/2025/65.html","/content/2025/66.html","/content/2025/67.html","/content/2025/68.html","/content/2025/69.html","/content/2025/70.html","/content/2025/71.html","/content/2025/72.html","/content/2025/73.html","/content/2025/74.html","/content/2025/75.html","/content/2025/76.html","/404.html","/collection/","/content/2024/","/content/","/content/2026/","/content/2025/","/category/","/tag/","/article/","/star/","/timeline/"],xe="SLIMSEARCH_QUERY_HISTORY",g=U(xe,[]),Re=()=>{const{queryHistoryCount:s}=w;return{enabled:s>0,queryHistories:g,addQueryHistory:r=>{g.value=Array.from(new Set([r,...g.value.slice(0,s-1)]))},removeQueryHistory:r=>{g.value=[...g.value.slice(0,r),...g.value.slice(r+1)]}}},$=s=>ke[s.id]+("anchor"in s?`#${s.anchor}`:""),we="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:M}=w,f=U(we,[]),Qe=()=>({enabled:M>0,resultHistories:f,addResultHistory:c=>{{const r={link:$(c),display:c.display};"header"in c&&(r.header=c.header),f.value=[r,...f.value.slice(0,M-1)]}},removeResultHistory:c=>{f.value=[...f.value.slice(0,c),...f.value.slice(c+1)]}}),be=s=>{const{page:c,routeLocale:r}=he(),Q=me(),a=D(0),H=R(()=>a.value>0),h=ve([]);return de(()=>{const{search:b,terminate:d}=ye(),k=ge(y=>{const{resultsFilter:S=n=>n,querySplitter:p,suggestionsFilter:A,...o}=Q.value;y?(a.value+=1,b(y,r.value,o).then(n=>S(n,y,r.value,c.value)).then(n=>{a.value-=1,h.value=n}).catch(n=>{console.warn(n),a.value-=1,a.value||(h.value=[])})):h.value=[]},w.searchDelay-w.suggestDelay,{maxWait:5e3});pe([s,r],([y])=>k(y.join(" "))),fe(()=>{d()})}),{isSearching:H,results:h}};var qe=K({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(s,{emit:c}){const r=N(),Q=X(),a=Z(ee),{addQueryHistory:H,queryHistories:h,removeQueryHistory:b}=Re(),{resultHistories:d,addResultHistory:k,removeResultHistory:y}=Qe(),S=te(s,"queries"),{results:p,isSearching:A}=be(S),o=le({isQuery:!0,index:0}),n=D(0),m=D(0),E=R(()=>h.value.length>0||d.value.length>0),q=R(()=>p.value.length>0),C=R(()=>p.value[n.value]||null),_=()=>{const{isQuery:t,index:l}=o;l===0?(o.isQuery=!t,o.index=t?d.value.length-1:h.value.length-1):o.index=l-1},O=()=>{const{isQuery:t,index:l}=o;l===(t?h.value.length-1:d.value.length-1)?(o.isQuery=!t,o.index=0):o.index=l+1},P=()=>{n.value=n.value>0?n.value-1:p.value.length-1,m.value=C.value.contents.length-1},Y=()=>{n.value=n.value<p.value.length-1?n.value+1:0,m.value=0},B=()=>{m.value<C.value.contents.length-1?m.value+=1:Y()},z=()=>{m.value>0?m.value-=1:P()},L=t=>t.map(l=>He(l)?l:e(l[0],l[1])),G=t=>{if(t.type==="customField"){const l=ie[t.index]||"$content",[v,i=""]=ue(l)?l[Q.value].split("$content"):l.split("$content");return t.display.map(u=>e("div",L([v,...u,i])))}return t.display.map(l=>e("div",L(l)))},x=()=>{n.value=0,m.value=0,c("updateQuery",""),c("close")},J=()=>e("div",{class:"slimsearch-records"},e("div",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},a.value.queryHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},h.value.map((t,l)=>{const v=o.isQuery&&o.index===l;return e("li",{class:["slimsearch-record-matches",{active:v}],role:"option","aria-selected":v,onClick:()=>{c("updateQuery",t)}},e("div",[e(T,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},t),e("button",{type:"button",class:"slimsearch-remove-icon",title:a.value.remove,"aria-label":a.value.remove,innerHTML:j,onClick:i=>{i.preventDefault(),i.stopPropagation(),b(l)}})]))}))])),V=()=>e("ul",{class:"slimsearch-records"},e("li",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},a.value.resultHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},d.value.map((t,l)=>{const v=!o.isQuery&&o.index===l;return e("li",{class:["slimsearch-record-matches",{active:v}],role:"option","aria-selected":v},e(I,{to:t.link,onClick:()=>{x()}},()=>[e(T,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[t.header?e("div",{class:"slimsearch-record-content-header"},t.header):null,e("div",t.display.map(i=>L(i)).flat())]),e("button",{type:"button",class:"slimsearch-remove-icon",title:a.value.remove,"aria-label":a.value.remove,innerHTML:j,onClick:i=>{i.preventDefault(),i.stopPropagation(),y(l)}})]))}))]));return ne("keydown",t=>{if(s.isFocusing){if(q.value){if(t.key==="ArrowUp")z();else if(t.key==="ArrowDown")B();else if(t.key==="Enter"){const l=C.value.contents[m.value];H(s.queries.join(" ")),k(l),r.push($(l)),x()}}else if(t.key==="ArrowUp")_();else if(t.key==="ArrowDown")O();else if(t.key==="Enter"){const{index:l}=o;o.isQuery?(t.preventDefault(),c("updateQuery",h.value[l])):(r.push(d.value[l].link),x())}}}),se([n,m],()=>{document.querySelector(".slimsearch-record.active .slimsearch-record-matches.active")?.scrollIntoView(!1)},{flush:"post"}),()=>e("div",{id:"slimsearch-results",class:["slimsearch-result-wrapper",{empty:s.queries.length?!q.value:!E.value}]},s.queries.length?A.value?e(ae,{hint:a.value.searching}):q.value?e("div",{class:"slimsearch-records",role:"listbox","aria-labeledby":"slimsearch-label"},p.value.map(({title:t,contents:l},v)=>{const i=n.value===v;return e("div",{class:["slimsearch-record",{active:i}],role:"group","aria-selected":i},[e("div",{class:"slimsearch-record-title"},t||a.value.defaultTitle),e("ul",{class:"slimsearch-record-contents"},l.map((u,W)=>{const F=i&&m.value===W;return e("li",{class:["slimsearch-record-matches",{active:F}],role:"option","aria-selected":F},e(I,{to:$(u),onClick:()=>{H(s.queries.join(" ")),k(u),x()}},()=>[u.type==="text"?null:e(u.type==="title"?oe:u.type==="heading"?ce:re,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[u.type==="text"&&u.header?e("div",{class:"slimsearch-record-content-header"},u.header):null,e("div",G(u))])]))}))])})):a.value.emptyResult:E.value?[J(),V()]:a.value.emptyHistory)}});export{qe as default};
